<!DOCTYPE html>
<html lang="es">
<head>
Â  <meta charset="UTF-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>Orange Store - Repuestos</title>
Â  <link rel="icon" href="logopeq.png" type="image/png">
Â  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

Â  <style>
Â  Â  * { box-sizing: border-box; } /* AÃ±adido box-sizing para consistencia */
Â  Â  body {
Â  Â  Â  margin:0;
Â  Â  Â  font-family:'Poppins',sans-serif;
Â  Â  Â  background:linear-gradient(135deg,#fff7ed,#ffe5d0);
Â  Â  Â  color:#1f2937;
Â  Â  Â  min-height:100vh;
Â  Â  Â  display:flex;
Â  Â  Â  flex-direction:column;
Â  Â  }

Â  Â  /* Header - Ajustado para incluir el toggle */
Â  Â  header {
Â  Â  Â  background:linear-gradient(90deg,#f97316,#ea580c);
Â  Â  Â  color:#fff;
Â  Â  Â  padding:12px 20px;
Â  Â  Â  display:flex;
Â  Â  Â  align-items:center;
Â  Â  Â  gap:10px;
Â  Â  Â  position:sticky;
Â  Â  Â  top:0;
Â  Â  Â  z-index:1000;
Â  Â  Â  box-shadow:0 4px 12px rgba(0,0,0,0.15);
Â  Â  }
Â  Â  .menu-toggle {
Â  Â  Â  font-size:24px;
Â  Â  Â  cursor:pointer;
Â  Â  Â  margin-right:6px;
Â  Â  }
Â  Â  header img { height:40px; cursor:pointer; }
Â  Â  header h1 { font-size:20px; margin:0; font-weight:600; }

Â  Â  /* Sidebar Styles */
Â  Â  .sidebar {
Â  Â  Â  height:100%;
Â  Â  Â  width:0;
Â  Â  Â  position:fixed;
Â  Â  Â  top:0;
Â  Â  Â  left:0;
Â  Â  Â  background:#fff;
Â  Â  Â  overflow-x:hidden;
Â  Â  Â  transition:0.3s;
Â  Â  Â  box-shadow:0 4px 20px rgba(0,0,0,0.2);
Â  Â  Â  z-index:2000;
Â  Â  Â  padding-top:60px;
Â  Â  }
Â  Â  .sidebar a {
Â  Â  Â  display:block;
Â  Â  Â  padding:14px 20px;
Â  Â  Â  text-decoration:none;
Â  Â  Â  font-size:16px;
Â  Â  Â  color:#222;
Â  Â  Â  font-weight:600;
Â  Â  Â  transition:0.2s;
Â  Â  }
Â  Â  .sidebar a:hover {
Â  Â  Â  background:#ffe9e0;
Â  Â  }
Â  Â  .sidebar .closebtn {
Â  Â  Â  position:absolute;
Â  Â  Â  top:12px;
Â  Â  Â  right:20px;
Â  Â  Â  font-size:28px;
Â  Â  Â  cursor:pointer;
Â  Â  Â  color:#333;
Â  Â  }
Â  Â  /* Fin Sidebar Styles */

Â  Â  .rate-bar {
Â  Â  Â  text-align:center;
Â  Â  Â  margin:10px 0;
Â  Â  }
Â  Â  .rate-bar label {
Â  Â  Â  font-weight:600;
Â  Â  Â  color:#ea580c;
Â  Â  Â  margin-right:6px;
Â  Â  }
Â  Â  .rate-bar input {
Â  Â  Â  padding:6px 10px;
Â  Â  Â  border:1px solid #ccc;
Â  Â  Â  border-radius:6px;
Â  Â  Â  max-width:100px;
Â  Â  Â  text-align:center; /* Centrar texto */
Â  Â  }

Â  Â  .search-area {
Â  Â  Â  text-align:center;
Â  Â  Â  margin:14px;
Â  Â  }
Â  Â  .search-area input {
Â  Â  Â  width:min(500px,90%);
Â  Â  Â  padding:10px 14px;
Â  Â  Â  border-radius:999px;
Â  Â  Â  border:1px solid #ddd;
Â  Â  Â  font-size:15px;
Â  Â  Â  outline:none;
Â  Â  Â  box-shadow:0 2px 6px rgba(0,0,0,0.08);
Â  Â  }

Â  Â  .filters {
Â  Â  Â  display:flex;
Â  Â  Â  gap:10px;
Â  Â  Â  justify-content:center;
Â  Â  Â  flex-wrap:wrap;
Â  Â  Â  margin-bottom:16px;
Â  Â  }
Â  Â  .filter-btn {
Â  Â  Â  border:2px solid #f97316;
Â  Â  Â  background:#fff;
Â  Â  Â  color:#f97316;
Â  Â  Â  padding:6px 14px;
Â  Â  Â  border-radius:999px;
Â  Â  Â  font-weight:600;
Â  Â  Â  cursor:pointer;
Â  Â  Â  font-size:14px;
Â  Â  Â  transition:all .2s;
Â  Â  }
Â  Â  .filter-btn.active {
Â  Â  Â  background:linear-gradient(90deg,#f97316,#ea580c);
Â  Â  Â  color:#fff;
Â  Â  Â  box-shadow:0 4px 12px rgba(234, 88, 12, 0.25);
Â  Â  }
Â  Â  .filter-btn:hover { /* Combinado con :active para hover */
Â  Â  Â  background:linear-gradient(90deg,#f97316,#ea580c);
Â  Â  Â  color:#fff;
Â  Â  }

Â  Â  .grid {
Â  Â  Â  max-width:1100px;
Â  Â  Â  margin:0 auto;
Â  Â  Â  padding:0 14px 40px;
Â  Â  Â  width:100%;
Â  Â  }

Â  Â  .card {
Â  Â  Â  background:#fff;
Â  Â  Â  border-radius:14px;
Â  Â  Â  margin-bottom:18px;
Â  Â  Â  box-shadow:0 4px 12px rgba(0,0,0,0.08);
Â  Â  Â  overflow:hidden;
Â  Â  }
Â  Â  .card-header {
Â  Â  Â  background:#ffedd5;
Â  Â  Â  padding:12px 16px;
Â  Â  Â  font-weight:600;
Â  Â  Â  color:#ea580c;
Â  Â  }
Â  Â  table {
Â  Â  Â  width:100%;
Â  Â  Â  border-collapse:collapse;
Â  Â  }
Â  Â  th,td {
Â  Â  Â  padding:10px 12px;
Â  Â  Â  border-bottom:1px solid #f1f1f1;
Â  Â  Â  font-size:14px;
Â  Â  }
Â  Â  th {
Â  Â  Â  background:#fafafa;
Â  Â  Â  text-align:left;
Â  Â  Â  color:#374151;
Â  Â  }
Â  Â  td { color:#222; }
Â  Â  td:nth-child(2), td:nth-child(3) { text-align:right; font-weight:600; } /* AlineaciÃ³n de precios */

Â  Â  .spinner {
Â  Â  Â  display:flex;
Â  Â  Â  align-items:center;
Â  Â  Â  justify-content:center;
Â  Â  Â  min-height:200px;
Â  Â  }
Â  Â  .spinner div {
Â  Â  Â  width:40px;
Â  Â  Â  height:40px;
Â  Â  Â  border:4px solid #f97316;
Â  Â  Â  border-top-color:transparent;
Â  Â  Â  border-radius:50%;
Â  Â  Â  animation:spin 1s linear infinite;
Â  Â  }
Â  Â  @keyframes spin { to { transform:rotate(360deg); } }

Â  Â  footer {
Â  Â  Â  text-align:center;
Â  Â  Â  padding:12px;
Â  Â  Â  font-size:13px;
Â  Â  Â  margin-top:auto;
Â  Â  Â  background:#fff7ed;
Â  Â  Â  color:#6b7280;
Â  Â  }

Â  Â  @media(max-width:720px){
Â  Â  Â  th,td{ font-size:13px; padding:8px; }
Â  Â  Â  header h1{ font-size:18px; }
Â  Â  }
Â  </style>
</head>
<body>
Â  <header>
Â  Â  <span class="menu-toggle" onclick="openMenu()">â˜°</span>
Â  Â  <img src="logo.png" alt="Logo" onclick="window.location.href='index.html'">
Â  Â  <h1>Orange Store - Repuestos</h1>
Â  </header>

Â  Â  <div id="sidebar" class="sidebar">
Â  Â  <span class="closebtn" onclick="closeMenu()">Ã—</span>
Â  Â  <a href="index.html">ğŸ  Volver al menÃº principal</a>
Â  Â  <a href="accesorios.html">ğŸ§ Accesorios</a>
Â  Â  <a href="#" onclick="logout()">ğŸšª Cerrar sesiÃ³n</a>
Â  </div>

Â  <div class="rate-bar">
Â  Â  <label for="tasaInput">Tasa Bs/$:</label>
Â  Â  <input type="number" id="tasaInput" step="0.01" placeholder="Ej: 36.00">
Â  </div>

Â  <div class="search-area">
Â  Â  <input id="search" type="text" placeholder="Buscar repuesto o modelo...">
Â  </div>

Â  <div class="filters">
Â  Â  <button class="filter-btn active" data-cat="all" onclick="filtrar('all',event)">Todos</button>
Â  Â  <button class="filter-btn" data-cat="apple" onclick="filtrar('apple',event)">Apple</button>
Â  Â  <button class="filter-btn" data-cat="samsung" onclick="filtrar('samsung',event)">Samsung</button>
Â  </div>

Â  <main class="grid" id="grid" aria-live="polite">
Â  Â  <div class="spinner" id="spinner"><div></div></div>
Â  </main>

Â  <footer>
Â  Â  Â© 2025 Orange Store. Todos los derechos reservados.
Â  </footer>

Â  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
Â  <script>
Â  Â  const DATA_FILE = "repuestos.json";
Â  Â  const FACTOR_PRECIO2 = 1.7;
Â  Â  let productos = [];
Â  Â  let fuse = null;
Â  Â  let filtroActivo = "all";

Â  Â  /* Funciones Auxiliares */
Â  Â  function escapeHtml(str=""){ return str.replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"}[m])); }
Â  Â  function parsePrice(val){ return parseFloat((val||"").toString().replace(",",".").replace(/[^0-9.]/g,"")); }
Â  Â  function formatMoney(n){ return isNaN(n)?"-":n.toFixed(2); }

Â  Â  function detectarMarca(modelo=""){
Â  Â  Â  const m = modelo.toLowerCase();
Â  Â  Â  if(m.includes("iphone")||m.includes("apple")) return "apple";
Â  Â  Â  if(m.includes("samsung")||m.startsWith("a")||m.startsWith("j")||m.startsWith("s")) return "samsung";
Â  Â  Â  return "otros";
Â  Â  }

Â  Â  /* Carga de Datos y Fuse.js */
Â  Â  fetch(DATA_FILE)
Â  Â  Â  .then(r=>r.json())
Â  Â  Â  .then(data=>{
Â  Â  Â  Â  productos = data || [];
Â  Â  Â  Â  fuse = new Fuse(productos, {
Â  Â  Â  Â  Â  keys:["modelo","repuestos.nombre"],
Â  Â  Â  Â  Â  threshold:0.3,
Â  Â  Â  Â  Â  ignoreLocation:true,
Â  Â  Â  Â  Â  minMatchCharLength:2,
Â  Â  Â  Â  });
Â  Â  Â  Â  document.getElementById("spinner").style.display="none";
Â  Â  Â  Â  mostrarProductos(productos);
Â  Â  Â  })
Â  Â  Â  .catch(err=>{
Â  Â  Â  Â  console.error("Error cargando datos:",err);
Â  Â  Â  Â  document.getElementById("grid").innerHTML="<p style='text-align:center;color:#b91c1c;'>Error cargando datos.</p>";
Â  Â  Â  });

Â  Â  /* Renderizado de Productos */
Â  Â  function mostrarProductos(lista){
Â  Â  Â  const grid=document.getElementById("grid");
Â  Â  Â  grid.innerHTML="";
Â  Â  Â  if(!lista||lista.length===0){
Â  Â  Â  Â  grid.innerHTML="<p style='text-align:center;color:#666;'>No se encontraron resultados</p>";
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  const tasa = parseFloat(localStorage.getItem("tasaBS")) || 0;
Â  Â  Â  const frag = document.createDocumentFragment();

Â  Â  Â  lista.forEach(item=>{
Â  Â  Â  Â  const card=document.createElement("div");
Â  Â  Â  Â  card.className="card";
Â  Â  Â  Â  card.innerHTML=`<div class="card-header">${escapeHtml(item.modelo||"")}</div>`;
Â  Â  Â  Â  const table=document.createElement("table");
Â  Â  Â  Â  table.innerHTML=`<thead>
Â  Â  Â  Â  Â  Â  <tr><th>Repuesto</th><th>Precio 1 ($)</th><th>Precio 2 ($/Bs)</th></tr>
Â  Â  Â  Â  Â  </thead><tbody></tbody>`;
Â  Â  Â  Â  const tbody=table.querySelector("tbody");

Â  Â  Â  Â  (item.repuestos||[]).forEach(r=>{
Â  Â  Â  Â  Â  const precio=parsePrice(r.precio);
Â  Â  Â  Â  Â  const precio2=precio*FACTOR_PRECIO2;
Â  Â  Â  Â  Â  const precio2bs = (!isNaN(precio2)&&tasa>0) ? `<br>(${formatMoney(precio2*tasa)} Bs)` : "";
Â  Â  Â  Â  Â  const tr=document.createElement("tr");
Â  Â  Â  Â  Â  tr.innerHTML=`<td>${escapeHtml(r.nombre||"")}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td style="color:#22c55e;">$${formatMoney(precio)}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td style="color:#f97316;">$${formatMoney(precio2)}${precio2bs}</td>`;
Â  Â  Â  Â  Â  tbody.appendChild(tr);
Â  Â  Â  Â  });

Â  Â  Â  Â  card.appendChild(table);
Â  Â  Â  Â  frag.appendChild(card);
Â  Â  Â  });
Â  Â  Â  grid.appendChild(frag);
Â  Â  }

Â  Â  /* Funcionalidad de Filtrado y BÃºsqueda */
Â  Â  function filtrar(cat="all",ev){
Â  Â  Â  filtroActivo=cat;
Â  Â  Â  document.querySelectorAll(".filter-btn").forEach(b=>b.classList.remove("active"));
Â  Â  Â  if(ev&&ev.target) ev.target.classList.add("active");

Â  Â  Â  let lista=productos;
Â  Â  Â  const texto=document.getElementById("search").value.trim();
Â  Â  Â  if(texto!==""&&fuse){
Â  Â  Â  Â  const resultados=fuse.search(texto);
Â  Â  Â  Â  lista=resultados.map(r=>r.item);
Â  Â  Â  }
Â  Â  Â  if(cat!=="all"){
Â  Â  Â  Â  lista=lista.filter(p=>detectarMarca(p.modelo)===cat);
Â  Â  Â  }
Â  Â  Â  mostrarProductos(lista);
Â  Â  }

Â  Â  /* Debounce para la BÃºsqueda */
Â  Â  let debounce;
Â  Â  document.getElementById("search").addEventListener("input",()=>{
Â  Â  Â  clearTimeout(debounce);
Â  Â  Â  debounce=setTimeout(()=>filtrar(filtroActivo),200);
Â  Â  });

Â  Â  /* Funcionalidad Tasa BS */
Â  Â  const tasaInput=document.getElementById("tasaInput");
Â  Â  if(tasaInput){
Â  Â  Â  const guardada=localStorage.getItem("tasaBS");
Â  Â  Â  if(guardada) tasaInput.value=guardada;
Â  Â  Â  tasaInput.addEventListener("input",()=>{
Â  Â  Â  Â  const val=parseFloat(tasaInput.value);
Â  Â  Â  Â  if(!isNaN(val)&&val>0){
Â  Â  Â  Â  Â  localStorage.setItem("tasaBS",val);
Â  Â  Â  Â  Â  filtrar(filtroActivo); /* Re-filtrar para actualizar precios */
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  }

Â  Â  /* Funcionalidad Sidebar */
Â  Â  function openMenu() {
Â  Â  Â  document.getElementById("sidebar").style.width = "250px";
Â  Â  }
Â  Â  function closeMenu() {
Â  Â  Â  document.getElementById("sidebar").style.width = "0";
Â  Â  }
Â  Â  /* Exportar funciones al scope global */
Â  Â  window.openMenu = openMenu;
Â  Â  window.closeMenu = closeMenu;
Â  Â  window.filtrar = filtrar;
Â  Â  window.logout = logout;

Â  Â  /* Control de Acceso */
Â  Â  function logout() {
Â  Â  Â  sessionStorage.removeItem("logueado");
Â  Â  Â  window.location.href = "login.html";
Â  Â  }
Â  Â  (function checkLogin(){
Â  Â  Â  if (sessionStorage.getItem("logueado") !== "true") {
Â  Â  Â  Â  window.location.href = "login.html";
Â  Â  Â  }
Â  Â  })();
Â  </script>
</body>
</html>
